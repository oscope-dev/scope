{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "title": "V1AlphaDoctorGroup",
  "description": "Resource used to define a `ScopeDoctorGroup`.",
  "type": "object",
  "properties": {
    "apiVersion": {
      "description": "API version of the resource",
      "$ref": "#/$defs/V1AlphaApiVersion"
    },
    "kind": {
      "description": "The type of resource.",
      "$ref": "#/$defs/DoctorGroupKind"
    },
    "metadata": {
      "description": "Standard set of options including name, description for the resource.\nTogether `kind` and `metadata.name` are required to be unique. If there are duplicate, the\nresources \"closest\" to the execution dir will take precedence.",
      "$ref": "#/$defs/ModelMetadata"
    },
    "spec": {
      "description": "Options for the resource.",
      "$ref": "#/$defs/DoctorGroupSpec"
    }
  },
  "additionalProperties": false,
  "required": [
    "apiVersion",
    "kind",
    "metadata",
    "spec"
  ],
  "$defs": {
    "DoctorCheckSpec": {
      "description": "What needs to be checked before the action will run. `paths` will be checked first, then\n`commands`. If a `path` matches no files or the matching files have changed, the `command` will run.",
      "type": "object",
      "properties": {
        "commands": {
          "description": "A list of commands to execute to check the environment.",
          "type": [
            "array",
            "null"
          ],
          "default": null,
          "items": {
            "type": "string"
          }
        },
        "paths": {
          "description": "A list of globs to check for changes. When the glob matches a new file, or the contents\nof the file change, the check will require a fix.\n\nRelative paths are relative to the scope config directory containing the config file.\n\nShared configs can use the template string `{{ working_dir }}` to access the working\ndirectory.",
          "type": [
            "array",
            "null"
          ],
          "default": null,
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    },
    "DoctorFixPromptSpec": {
      "type": "object",
      "properties": {
        "extraContext": {
          "description": "Additional context for why they're being prompted for approval",
          "type": [
            "string",
            "null"
          ],
          "default": null
        },
        "text": {
          "description": "Yes/No question presented to the user",
          "type": "string",
          "default": ""
        }
      },
      "additionalProperties": false
    },
    "DoctorFixSpec": {
      "description": "Definition for fixing the environment.",
      "type": "object",
      "properties": {
        "commands": {
          "description": "List of commands to run to fix the env.",
          "type": "array",
          "default": [],
          "items": {
            "type": "string"
          }
        },
        "helpText": {
          "description": "Text to display when no command is provided / fails to fix the env.",
          "type": [
            "string",
            "null"
          ],
          "default": null
        },
        "helpUrl": {
          "description": "Link to documentation to fix the issue.",
          "type": [
            "string",
            "null"
          ],
          "default": null
        },
        "prompt": {
          "description": "When present, user will be prompted for approval before running the fix",
          "anyOf": [
            {
              "$ref": "#/$defs/DoctorFixPromptSpec"
            },
            {
              "type": "null"
            }
          ],
          "default": null
        }
      },
      "additionalProperties": false
    },
    "DoctorGroupActionSpec": {
      "description": "An action is a single step used to check in a group. This is most commonly used to build a\nseries of tasks for a system, like `ruby`, `python`, and databases.",
      "type": "object",
      "properties": {
        "check": {
          "description": "The `check` run before `fix` (if provided). A check is used to determine if the fix needs\nto be executed, or fail the action if no fix is provided. If a fix is specified, the check\nwill re-execute to ensure that the fix applied correctly.",
          "$ref": "#/$defs/DoctorCheckSpec"
        },
        "description": {
          "description": "A description of this specific action, used for information to the users.",
          "type": [
            "string",
            "null"
          ]
        },
        "fix": {
          "description": "A fix defines how to fix the issue that a `check` is validating. When provided, will only\nrun when the `check` \"fails\".",
          "anyOf": [
            {
              "$ref": "#/$defs/DoctorFixSpec"
            },
            {
              "type": "null"
            }
          ]
        },
        "name": {
          "description": "Name of the \"action\" used when reporting status to the users.",
          "type": "string"
        },
        "required": {
          "description": "If false, the action is allowed to fail and let other actions in the group execute. Defaults\nto `true`.",
          "type": "boolean",
          "default": true
        }
      },
      "additionalProperties": false,
      "required": [
        "name",
        "check"
      ]
    },
    "DoctorGroupKind": {
      "type": "string",
      "enum": [
        "ScopeDoctorGroup"
      ]
    },
    "DoctorGroupSpec": {
      "description": "Often used to describe how to fix a \"system\", like `ruby`, `python`, or databases. Able to\ndepend on other \"system\".",
      "type": "object",
      "properties": {
        "actions": {
          "description": "A series of steps to check and fix for the group.",
          "type": "array",
          "items": {
            "$ref": "#/$defs/DoctorGroupActionSpec"
          }
        },
        "include": {
          "description": "Change how a group is handled when building the dependency task graph.\nWhen set to `when-required`, the group will be ignored unless it's required by another\ndependency.",
          "$ref": "#/$defs/DoctorInclude",
          "default": "by-default"
        },
        "needs": {
          "description": "A list of `ScopeDoctorGroup` that are required for this group to execute. If not all finish\nsuccessfully, this group will not execute.",
          "type": "array",
          "default": [],
          "items": {
            "type": "string"
          }
        },
        "reportExtraDetails": {
          "description": "defines additional data that needs to be pulled from the system when reporting a bug.\n`reportExtraDetails` is a map of `string:string`, the value is a command that should be run.\nWhen a report is built, the commands will be run and automatically included in the report.",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "default": {}
        },
        "skip": {
          "description": "Defines conditions under which the group should be skipped.\n`skip` can be a boolean, in which case the group will be skipped if `true`.\nAlternatively, it can be a command that will be run to determine if the group should\nbe skipped. If the command returns a zero exit code, the group will be skipped.\nIf the command returns a non-zero exit code, the group will not be skipped.",
          "$ref": "#/$defs/SkipSpec",
          "default": false
        }
      },
      "additionalProperties": false,
      "required": [
        "actions"
      ]
    },
    "DoctorInclude": {
      "description": "Configure how a groups will be used when determining the task graph.",
      "oneOf": [
        {
          "description": "Default option, the group will be included by default when determining which groups should\nrun.",
          "type": "string",
          "const": "by-default"
        },
        {
          "description": "Useful for shared configuration. The group will not run unless another group depends on it.",
          "type": "string",
          "const": "when-required"
        }
      ]
    },
    "KnownErrorKind": {
      "type": "string",
      "enum": [
        "ScopeKnownError"
      ]
    },
    "KnownErrorSpec": {
      "description": "Definition of the known error",
      "type": "object",
      "properties": {
        "fix": {
          "description": "An optional fix the user will be prompted to run.",
          "anyOf": [
            {
              "$ref": "#/$defs/DoctorFixSpec"
            },
            {
              "type": "null"
            }
          ]
        },
        "help": {
          "description": "Text that the user can use to fix the issue",
          "type": "string"
        },
        "pattern": {
          "description": "A Regex used to determine if the line is an error.",
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "help",
        "pattern"
      ]
    },
    "ModelMetadata": {
      "type": "object",
      "properties": {
        "annotations": {
          "description": "Annotations attach arbitrary non-identifying metadata to objects.",
          "$ref": "#/$defs/ModelMetadataAnnotations",
          "default": {
            "scope.github.com/bin-path": null,
            "working_dir": null
          }
        },
        "description": {
          "description": "Description of this resource, used when listing resources and helpful to inform users why\nthe resource exists.",
          "type": "string",
          "default": "Description not provided"
        },
        "labels": {
          "description": "Key/value pairs, allows resources to be easily filtered from the CLI.",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "default": {}
        },
        "name": {
          "description": "Name of the resource, needs to be unique across `kinds`. When two resources share a name,\nthe one \"closest\" to the current working directory will take precedence.",
          "type": "string"
        }
      },
      "required": [
        "name"
      ]
    },
    "ModelMetadataAnnotations": {
      "type": "object",
      "properties": {
        "scope.github.com/bin-path": {
          "description": "When running commands, additional paths that should be paced at the _beginning_ of the `PATH`.",
          "type": [
            "string",
            "null"
          ]
        },
        "working_dir": {
          "description": "The current working directory of the scope command, generated automatically.",
          "type": [
            "string",
            "null"
          ]
        }
      },
      "additionalProperties": {
        "type": "string"
      }
    },
    "ReportDestinationGithubIssueSpec": {
      "description": "How to load the report to GitHub Issue",
      "type": "object",
      "properties": {
        "owner": {
          "description": "`owner` of the repository for the issue",
          "type": "string"
        },
        "repo": {
          "description": "`repo` the name of the repo for the issue",
          "type": "string"
        },
        "tags": {
          "description": "A list of tags to be added to the issue",
          "type": "array",
          "default": [],
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false,
      "required": [
        "owner",
        "repo"
      ]
    },
    "ReportDestinationLocalSpec": {
      "description": "Create a report that is only local",
      "type": "object",
      "properties": {
        "directory": {
          "description": "Directory to put the report into",
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "directory"
      ]
    },
    "ReportDestinationRustyPasteSpec": {
      "description": "How to upload a report to RustyPaste",
      "type": "object",
      "properties": {
        "url": {
          "description": "URL of RustyPaste",
          "type": "string"
        }
      },
      "additionalProperties": false,
      "required": [
        "url"
      ]
    },
    "ReportDestinationSpec": {
      "oneOf": [
        {
          "type": "object",
          "properties": {
            "rustyPaste": {
              "$ref": "#/$defs/ReportDestinationRustyPasteSpec"
            }
          },
          "additionalProperties": false,
          "required": [
            "rustyPaste"
          ]
        },
        {
          "type": "object",
          "properties": {
            "githubIssue": {
              "$ref": "#/$defs/ReportDestinationGithubIssueSpec"
            }
          },
          "additionalProperties": false,
          "required": [
            "githubIssue"
          ]
        },
        {
          "type": "object",
          "properties": {
            "local": {
              "$ref": "#/$defs/ReportDestinationLocalSpec"
            }
          },
          "additionalProperties": false,
          "required": [
            "local"
          ]
        }
      ]
    },
    "ReportDestinationTemplates": {
      "type": "object",
      "properties": {
        "analyze": {
          "description": "Template to use when generating a bug without with analyze or intercept\nA Jinja2 style template, to be included. The text should be in Markdown format. Scope\ninjects `command` as the command that was run.",
          "type": [
            "string",
            "null"
          ]
        },
        "doctor": {
          "description": "Template to use when generating a bug report with `scope doctor`\nA Jinja2 style template, to be included. The text should be in Markdown format. Scope\ninjects `command` as the command that was run.",
          "type": [
            "string",
            "null"
          ]
        },
        "title": {
          "description": "Title to use when creating the issue. This is a Jinja2 style template. `entrypoint` is\nprovided as a variable, which is the scope command run.",
          "type": [
            "string",
            "null"
          ]
        }
      },
      "additionalProperties": {
        "type": "string"
      }
    },
    "ReportLocationKind": {
      "type": "string",
      "enum": [
        "ScopeReportLocation"
      ]
    },
    "ReportLocationSpec": {
      "description": "Define where to upload the report to",
      "type": "object",
      "properties": {
        "additionalData": {
          "description": "defines additional data that needs to be pulled from the system when reporting a bug.\n`additionalData` is a map of `string:string`, the value is a command that should be run.\nWhen a report is built, the commands will be run and automatically included in the report.",
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "default": {}
        },
        "destination": {
          "description": "Destination the report should be uploaded to",
          "$ref": "#/$defs/ReportDestinationSpec"
        },
        "templates": {
          "description": "Templates to use when uploading a report",
          "$ref": "#/$defs/ReportDestinationTemplates",
          "default": {
            "analyze": null,
            "doctor": null,
            "title": null
          }
        }
      },
      "additionalProperties": false,
      "required": [
        "destination"
      ]
    },
    "SkipSpec": {
      "anyOf": [
        {
          "type": "boolean"
        },
        {
          "type": "object",
          "properties": {
            "command": {
              "type": "string"
            }
          },
          "required": [
            "command"
          ]
        }
      ]
    },
    "V1AlphaApiVersion": {
      "description": "Version of the Scope API",
      "oneOf": [
        {
          "description": "Current latest version of the resources.",
          "type": "string",
          "const": "scope.github.com/v1alpha"
        }
      ]
    },
    "V1AlphaDoctorGroup": {
      "description": "Resource used to define a `ScopeDoctorGroup`.",
      "type": "object",
      "properties": {
        "apiVersion": {
          "description": "API version of the resource",
          "$ref": "#/$defs/V1AlphaApiVersion"
        },
        "kind": {
          "description": "The type of resource.",
          "$ref": "#/$defs/DoctorGroupKind"
        },
        "metadata": {
          "description": "Standard set of options including name, description for the resource.\nTogether `kind` and `metadata.name` are required to be unique. If there are duplicate, the\nresources \"closest\" to the execution dir will take precedence.",
          "$ref": "#/$defs/ModelMetadata"
        },
        "spec": {
          "description": "Options for the resource.",
          "$ref": "#/$defs/DoctorGroupSpec"
        }
      },
      "additionalProperties": false,
      "required": [
        "apiVersion",
        "kind",
        "metadata",
        "spec"
      ]
    },
    "V1AlphaKnownError": {
      "description": "Resource used to define a `ScopeKnownError`.\nA known error is a specific error that a user may run into.",
      "type": "object",
      "properties": {
        "apiVersion": {
          "description": "API version of the resource",
          "$ref": "#/$defs/V1AlphaApiVersion"
        },
        "kind": {
          "description": "The type of resource.",
          "$ref": "#/$defs/KnownErrorKind"
        },
        "metadata": {
          "description": "Standard set of options including name, description for the resource.\nTogether `kind` and `metadata.name` are required to be unique. If there are duplicate, the\nresources \"closest\" to the execution dir will take precedence.",
          "$ref": "#/$defs/ModelMetadata"
        },
        "spec": {
          "description": "Options for the resource.",
          "$ref": "#/$defs/KnownErrorSpec"
        }
      },
      "additionalProperties": false,
      "required": [
        "apiVersion",
        "kind",
        "metadata",
        "spec"
      ]
    },
    "V1AlphaReportLocation": {
      "description": "A `ScopeReportLocation` tells where to upload a report to.",
      "type": "object",
      "properties": {
        "apiVersion": {
          "description": "API version of the resource",
          "$ref": "#/$defs/V1AlphaApiVersion"
        },
        "kind": {
          "description": "The type of resource.",
          "$ref": "#/$defs/ReportLocationKind"
        },
        "metadata": {
          "description": "Standard set of options including name, description for the resource.\nTogether `kind` and `metadata.name` are required to be unique. If there are duplicate, the\nresources \"closest\" to the execution dir will take precedence.",
          "$ref": "#/$defs/ModelMetadata"
        },
        "spec": {
          "description": "Options for the resource.",
          "$ref": "#/$defs/ReportLocationSpec"
        }
      },
      "additionalProperties": false,
      "required": [
        "apiVersion",
        "kind",
        "metadata",
        "spec"
      ]
    }
  }
}